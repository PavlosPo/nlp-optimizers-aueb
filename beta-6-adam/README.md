This is the adam version of our code.